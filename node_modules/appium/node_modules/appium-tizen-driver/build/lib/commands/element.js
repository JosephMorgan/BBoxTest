"use strict";

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = exports.commands = void 0;

var _asyncToGenerator2 = _interopRequireDefault(require("@babel/runtime/helpers/asyncToGenerator"));

var _logger = _interopRequireDefault(require("../logger"));

var _lodash = _interopRequireDefault(require("lodash"));

var _asyncbox = require("asyncbox");

let commands = {},
    extensions = {};
exports.commands = commands;

commands.getAttribute = function () {
  var _ref = (0, _asyncToGenerator2.default)(function* (attribute, elementId) {
    elementId = this.getAutomationId(elementId);
    let params = {
      attribute,
      elementId
    };
    return yield this.bootstrap.sendAction("element:getAttribute", params);
  });

  return function (_x, _x2) {
    return _ref.apply(this, arguments);
  };
}();

commands.setAttribute = function () {
  var _ref2 = (0, _asyncToGenerator2.default)(function* (attribute, value, elementId) {
    elementId = this.getAutomationId(elementId);
    let params = {
      attribute,
      value,
      elementId
    };
    return yield this.bootstrap.sendAction("element:setAttribute", params);
  });

  return function (_x3, _x4, _x5) {
    return _ref2.apply(this, arguments);
  };
}();

commands.getLocation = function () {
  var _ref3 = (0, _asyncToGenerator2.default)(function* (elementId) {
    elementId = this.getAutomationId(elementId);
    return yield this.bootstrap.sendAction("element:location", {
      elementId
    });
  });

  return function (_x6) {
    return _ref3.apply(this, arguments);
  };
}();

commands.getLocationInView = function () {
  var _ref4 = (0, _asyncToGenerator2.default)(function* (elementId) {
    return yield this.getLocation(elementId);
  });

  return function (_x7) {
    return _ref4.apply(this, arguments);
  };
}();

commands.getLocationValueByElementId = function () {
  var _ref5 = (0, _asyncToGenerator2.default)(function* (elementId) {
    return yield this.getLocation(elementId);
  });

  return function (_x8) {
    return _ref5.apply(this, arguments);
  };
}();

commands.getText = function () {
  var _ref6 = (0, _asyncToGenerator2.default)(function* (elementId) {
    elementId = this.getAutomationId(elementId);
    return yield this.bootstrap.sendAction("element:getText", {
      elementId
    });
  });

  return function (_x9) {
    return _ref6.apply(this, arguments);
  };
}();

commands.elementEnabled = function () {
  var _ref7 = (0, _asyncToGenerator2.default)(function* (elementId) {
    elementId = this.getAutomationId(elementId);
    return yield this.bootstrap.sendAction("element:enabled", {
      elementId
    });
  });

  return function (_x10) {
    return _ref7.apply(this, arguments);
  };
}();

commands.elementDisplayed = function () {
  var _ref8 = (0, _asyncToGenerator2.default)(function* (elementId) {
    elementId = this.getAutomationId(elementId);
    return yield this.bootstrap.sendAction("element:displayed", {
      elementId
    });
  });

  return function (_x11) {
    return _ref8.apply(this, arguments);
  };
}();

commands.elementSelected = function () {
  _logger.default.info('elementSelected not supported');

  return false;
};

commands.getSize = function () {
  var _ref9 = (0, _asyncToGenerator2.default)(function* (elementId) {
    elementId = this.getAutomationId(elementId);
    return yield this.bootstrap.sendAction("element:size", {
      elementId
    });
  });

  return function (_x12) {
    return _ref9.apply(this, arguments);
  };
}();

commands.setValue = function () {
  var _ref10 = (0, _asyncToGenerator2.default)(function* (keys, elementId) {
    let text = keys.join();
    elementId = this.getAutomationId(elementId);
    let params = {
      elementId,
      text,
      replace: false
    };
    return yield this.bootstrap.sendAction("element:setText", params);
  });

  return function (_x13, _x14) {
    return _ref10.apply(this, arguments);
  };
}();

commands.setValueImmediate = function () {
  var _ref11 = (0, _asyncToGenerator2.default)(function* (keys, elementId) {
    let text = _lodash.default.isArray(keys) ? keys.join('') : keys;
    elementId = this.getAutomationId(elementId);
    let params = {
      elementId,
      text,
      replace: false
    };
    return yield this.bootstrap.sendAction("element:setText", params);
  });

  return function (_x15, _x16) {
    return _ref11.apply(this, arguments);
  };
}();

commands.clear = function () {
  var _ref12 = (0, _asyncToGenerator2.default)(function* (elementId) {
    elementId = this.getAutomationId(elementId);
    let params = {
      elementId,
      text: "",
      replace: true
    };
    return yield this.bootstrap.sendAction("element:setText", params);
  });

  return function (_x17) {
    return _ref12.apply(this, arguments);
  };
}();

commands.replaceValue = function () {
  var _ref13 = (0, _asyncToGenerator2.default)(function* (value, elementId) {
    elementId = this.getAutomationId(elementId);
    let params = {
      elementId,
      text: value,
      replace: true
    };
    return yield this.bootstrap.sendAction("element:setText", params);
  });

  return function (_x18, _x19) {
    return _ref13.apply(this, arguments);
  };
}();

commands.click = function () {
  var _ref14 = (0, _asyncToGenerator2.default)(function* (elementId, x = 0, y = 0) {
    if (x === this.sessionId) {
      x = 0;
    }

    if (y === this.sessionId) {
      y = 0;
    }

    if (elementId) {
      elementId = this.getAutomationId(elementId);
    } else {
      elementId = "";
    }

    let params = {
      elementId,
      x: _lodash.default.toInteger(x),
      y: _lodash.default.toInteger(y)
    };
    return yield this.bootstrap.sendAction("element:click", params);
  });

  return function (_x20) {
    return _ref14.apply(this, arguments);
  };
}();

commands.touchUp = function () {
  var _ref15 = (0, _asyncToGenerator2.default)(function* (x = 1, y = 1, elementId = "") {
    if (elementId && elementId !== this.sessionId) {
      elementId = this.getAutomationId(elementId);
    } else {
      elementId = "";
    }

    let params = {
      elementId,
      x: _lodash.default.toInteger(x),
      y: _lodash.default.toInteger(y)
    };
    return yield this.bootstrap.sendAction("element:touchUp", params);
  });

  return function () {
    return _ref15.apply(this, arguments);
  };
}();

commands.touchDown = function () {
  var _ref16 = (0, _asyncToGenerator2.default)(function* (x, y, elementId = "") {
    if (elementId && elementId !== this.sessionId) {
      elementId = this.getAutomationId(elementId);
    } else {
      elementId = "";
    }

    let params = {
      elementId,
      x: _lodash.default.toInteger(x),
      y: _lodash.default.toInteger(y)
    };
    return yield this.bootstrap.sendAction("element:touchDown", params);
  });

  return function (_x21, _x22) {
    return _ref16.apply(this, arguments);
  };
}();

commands.touchMove = function () {
  var _ref17 = (0, _asyncToGenerator2.default)(function* (xDown, yDown, xUp, yUp, steps = 10, elementId = null) {
    if (elementId && elementId !== this.sessionId) {
      elementId = this.getAutomationId(elementId);
    } else {
      elementId = "";
    }

    let params = {
      elementId,
      xDown: _lodash.default.toInteger(xDown),
      yDown: _lodash.default.toInteger(yDown),
      xUp: _lodash.default.toInteger(xUp),
      yUp: _lodash.default.toInteger(yUp),
      steps: _lodash.default.toInteger(steps)
    };
    return yield this.bootstrap.sendAction("element:touchMove", params);
  });

  return function (_x23, _x24, _x25, _x26) {
    return _ref17.apply(this, arguments);
  };
}();

commands.touchLongClick = function () {
  var _ref18 = (0, _asyncToGenerator2.default)(function* (elementId, x, y, duration) {
    yield this.touchDown(x, y, elementId);
    yield (0, _asyncbox.sleep)(duration);
    return yield this.touchUp(x, y, elementId);
  });

  return function (_x27, _x28, _x29, _x30) {
    return _ref18.apply(this, arguments);
  };
}();

commands.tap = function () {
  var _ref19 = (0, _asyncToGenerator2.default)(function* (elementId, x = 0, y = 0, count = 1) {
    let result = true;
    let tapResult = false;

    for (let i = 0; i < count; i++) {
      tapResult = yield this.click(elementId, x, y);

      if (!tapResult) {
        result = false;
      }
    }

    return result;
  });

  return function (_x31) {
    return _ref19.apply(this, arguments);
  };
}();

Object.assign(extensions, commands);
var _default = extensions;
exports.default = _default;require('source-map-support').install();


//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImxpYi9jb21tYW5kcy9lbGVtZW50LmpzIl0sIm5hbWVzIjpbImNvbW1hbmRzIiwiZXh0ZW5zaW9ucyIsImdldEF0dHJpYnV0ZSIsImF0dHJpYnV0ZSIsImVsZW1lbnRJZCIsImdldEF1dG9tYXRpb25JZCIsInBhcmFtcyIsImJvb3RzdHJhcCIsInNlbmRBY3Rpb24iLCJzZXRBdHRyaWJ1dGUiLCJ2YWx1ZSIsImdldExvY2F0aW9uIiwiZ2V0TG9jYXRpb25JblZpZXciLCJnZXRMb2NhdGlvblZhbHVlQnlFbGVtZW50SWQiLCJnZXRUZXh0IiwiZWxlbWVudEVuYWJsZWQiLCJlbGVtZW50RGlzcGxheWVkIiwiZWxlbWVudFNlbGVjdGVkIiwibG9nIiwiaW5mbyIsImdldFNpemUiLCJzZXRWYWx1ZSIsImtleXMiLCJ0ZXh0Iiwiam9pbiIsInJlcGxhY2UiLCJzZXRWYWx1ZUltbWVkaWF0ZSIsIl8iLCJpc0FycmF5IiwiY2xlYXIiLCJyZXBsYWNlVmFsdWUiLCJjbGljayIsIngiLCJ5Iiwic2Vzc2lvbklkIiwidG9JbnRlZ2VyIiwidG91Y2hVcCIsInRvdWNoRG93biIsInRvdWNoTW92ZSIsInhEb3duIiwieURvd24iLCJ4VXAiLCJ5VXAiLCJzdGVwcyIsInRvdWNoTG9uZ0NsaWNrIiwiZHVyYXRpb24iLCJ0YXAiLCJjb3VudCIsInJlc3VsdCIsInRhcFJlc3VsdCIsImkiLCJPYmplY3QiLCJhc3NpZ24iXSwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7O0FBQUE7O0FBQ0E7O0FBQ0E7O0FBQ0EsSUFBSUEsUUFBUSxHQUFHLEVBQWY7QUFBQSxJQUFtQkMsVUFBVSxHQUFHLEVBQWhDOzs7QUFFQUQsUUFBUSxDQUFDRSxZQUFUO0FBQUEsNkNBQXdCLFdBQWdCQyxTQUFoQixFQUEyQkMsU0FBM0IsRUFBc0M7QUFDNURBLElBQUFBLFNBQVMsR0FBRyxLQUFLQyxlQUFMLENBQXFCRCxTQUFyQixDQUFaO0FBQ0EsUUFBSUUsTUFBTSxHQUFHO0FBQ1hILE1BQUFBLFNBRFc7QUFF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QkQsUUFBMUI7ZUFFZUMsVSIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBsb2cgZnJvbSAnLi4vbG9nZ2VyJztcbmltcG9ydCBfIGZyb20gJ2xvZGFzaCc7XG5pbXBvcnQgeyBzbGVlcCB9IGZyb20gJ2FzeW5jYm94JztcbmxldCBjb21tYW5kcyA9IHt9LCBleHRlbnNpb25zID0ge307XG5cbmNvbW1hbmRzLmdldEF0dHJpYnV0ZSA9IGFzeW5jIGZ1bmN0aW9uIChhdHRyaWJ1dGUsIGVsZW1lbnRJZCkge1xuICBlbGVtZW50SWQgPSB0aGlzLmdldEF1dG9tYXRpb25JZChlbGVtZW50SWQpO1xuICBsZXQgcGFyYW1zID0ge1xuICAgIGF0dHJpYnV0ZSxcbiAgICBlbGVtZW50SWRcbiAgfTtcbiAgcmV0dXJuIGF3YWl0IHRoaXMuYm9vdHN0cmFwLnNlbmRBY3Rpb24oXCJlbGVtZW50OmdldEF0dHJpYnV0ZVwiLCBwYXJhbXMpO1xufTtcblxuY29tbWFuZHMuc2V0QXR0cmlidXRlID0gYXN5bmMgZnVuY3Rpb24gKGF0dHJpYnV0ZSwgdmFsdWUsIGVsZW1lbnRJZCkge1xuICBlbGVtZW50SWQgPSB0aGlzLmdldEF1dG9tYXRpb25JZChlbGVtZW50SWQpO1xuICBsZXQgcGFyYW1zID0ge1xuICAgIGF0dHJpYnV0ZSxcbiAgICB2YWx1ZSxcbiAgICBlbGVtZW50SWRcbiAgfTtcbiAgcmV0dXJuIGF3YWl0IHRoaXMuYm9vdHN0cmFwLnNlbmRBY3Rpb24oXCJlbGVtZW50OnNldEF0dHJpYnV0ZVwiLCBwYXJhbXMpO1xufTtcblxuY29tbWFuZHMuZ2V0TG9jYXRpb24gPSBhc3luYyBmdW5jdGlvbiAoZWxlbWVudElkKSB7XG4gIGVsZW1lbnRJZCA9IHRoaXMuZ2V0QXV0b21hdGlvbklkKGVsZW1lbnRJZCk7XG4gIHJldHVybiBhd2FpdCB0aGlzLmJvb3RzdHJhcC5zZW5kQWN0aW9uKFwiZWxlbWVudDpsb2NhdGlvblwiLCB7IGVsZW1lbnRJZCB9KTtcbn07XG5cbmNvbW1hbmRzLmdldExvY2F0aW9uSW5WaWV3ID0gYXN5bmMgZnVuY3Rpb24gKGVsZW1lbnRJZCkge1xuICByZXR1cm4gYXdhaXQgdGhpcy5nZXRMb2NhdGlvbihlbGVtZW50SWQpO1xufTtcblxuY29tbWFuZHMuZ2V0TG9jYXRpb25WYWx1ZUJ5RWxlbWVudElkID0gYXN5bmMgZnVuY3Rpb24gKGVsZW1lbnRJZCkge1xuICByZXR1cm4gYXdhaXQgdGhpcy5nZXRMb2NhdGlvbihlbGVtZW50SWQpO1xufTtcblxuY29tbWFuZHMuZ2V0VGV4dCA9IGFzeW5jIGZ1bmN0aW9uIChlbGVtZW50SWQpIHtcbiAgZWxlbWVudElkID0gdGhpcy5nZXRBdXRvbWF0aW9uSWQoZWxlbWVudElkKTtcbiAgcmV0dXJuIGF3YWl0IHRoaXMuYm9vdHN0cmFwLnNlbmRBY3Rpb24oXCJlbGVtZW50OmdldFRleHRcIiwgeyBlbGVtZW50SWQgfSk7XG59O1xuXG5jb21tYW5kcy5lbGVtZW50RW5hYmxlZCA9IGFzeW5jIGZ1bmN0aW9uIChlbGVtZW50SWQpIHtcbiAgZWxlbWVudElkID0gdGhpcy5nZXRBdXRvbWF0aW9uSWQoZWxlbWVudElkKTtcbiAgcmV0dXJuIGF3YWl0IHRoaXMuYm9vdHN0cmFwLnNlbmRBY3Rpb24oXCJlbGVtZW50OmVuYWJsZWRcIiwgeyBlbGVtZW50SWQgfSk7XG59O1xuXG5jb21tYW5kcy5lbGVtZW50RGlzcGxheWVkID0gYXN5bmMgZnVuY3Rpb24gKGVsZW1lbnRJZCkge1xuICBlbGVtZW50SWQgPSB0aGlzLmdldEF1dG9tYXRpb25JZChlbGVtZW50SWQpO1xuICByZXR1cm4gYXdhaXQgdGhpcy5ib290c3RyYXAuc2VuZEFjdGlvbihcImVsZW1lbnQ6ZGlzcGxheWVkXCIsIHsgZWxlbWVudElkIH0pO1xufTtcblxuY29tbWFuZHMuZWxlbWVudFNlbGVjdGVkID0gZnVuY3Rpb24gKCkge1xuICBsb2cuaW5mbygnZWxlbWVudFNlbGVjdGVkIG5vdCBzdXBwb3J0ZWQnKTtcbiAgcmV0dXJuIGZhbHNlO1xufTtcblxuY29tbWFuZHMuZ2V0U2l6ZSA9IGFzeW5jIGZ1bmN0aW9uIChlbGVtZW50SWQpIHtcbiAgZWxlbWVudElkID0gdGhpcy5nZXRBdXRvbWF0aW9uSWQoZWxlbWVudElkKTtcbiAgcmV0dXJuIGF3YWl0IHRoaXMuYm9vdHN0cmFwLnNlbmRBY3Rpb24oXCJlbGVtZW50OnNpemVcIiwgeyBlbGVtZW50SWQgfSk7XG59O1xuXG5jb21tYW5kcy5zZXRWYWx1ZSA9IGFzeW5jIGZ1bmN0aW9uIChrZXlzLCBlbGVtZW50SWQpIHtcbiAgbGV0IHRleHQgPSBrZXlzLmpvaW4oKTtcbiAgZWxlbWVudElkID0gdGhpcy5nZXRBdXRvbWF0aW9uSWQoZWxlbWVudElkKTtcbiAgbGV0IHBhcmFtcyA9IHtcbiAgICBlbGVtZW50SWQsXG4gICAgdGV4dCxcbiAgICByZXBsYWNlOiBmYWxzZVxuICB9O1xuICByZXR1cm4gYXdhaXQgdGhpcy5ib290c3RyYXAuc2VuZEFjdGlvbihcImVsZW1lbnQ6c2V0VGV4dFwiLCBwYXJhbXMpO1xufTtcblxuY29tbWFuZHMuc2V0VmFsdWVJbW1lZGlhdGUgPSBhc3luYyBmdW5jdGlvbiAoa2V5cywgZWxlbWVudElkKSB7XG4gIGxldCB0ZXh0ID0gXy5pc0FycmF5KGtleXMpID8ga2V5cy5qb2luKCcnKSA6IGtleXM7XG4gIGVsZW1lbnRJZCA9IHRoaXMuZ2V0QXV0b21hdGlvbklkKGVsZW1lbnRJZCk7XG4gIGxldCBwYXJhbXMgPSB7XG4gICAgZWxlbWVudElkLFxuICAgIHRleHQsXG4gICAgcmVwbGFjZTogZmFsc2VcbiAgfTtcbiAgcmV0dXJuIGF3YWl0IHRoaXMuYm9vdHN0cmFwLnNlbmRBY3Rpb24oXCJlbGVtZW50OnNldFRleHRcIiwgcGFyYW1zKTtcbn07XG5cbmNvbW1hbmRzLmNsZWFyID0gYXN5bmMgZnVuY3Rpb24gKGVsZW1lbnRJZCkge1xuICBlbGVtZW50SWQgPSB0aGlzLmdldEF1dG9tYXRpb25JZChlbGVtZW50SWQpO1xuICBsZXQgcGFyYW1zID0ge1xuICAgIGVsZW1lbnRJZCxcbiAgICB0ZXh0OiBcIlwiLFxuICAgIHJlcGxhY2U6IHRydWVcbiAgfTtcbiAgcmV0dXJuIGF3YWl0IHRoaXMuYm9vdHN0cmFwLnNlbmRBY3Rpb24oXCJlbGVtZW50OnNldFRleHRcIiwgcGFyYW1zKTtcbn07XG5cbmNvbW1hbmRzLnJlcGxhY2VWYWx1ZSA9IGFzeW5jIGZ1bmN0aW9uICh2YWx1ZSwgZWxlbWVudElkKSB7XG4gIGVsZW1lbnRJZCA9IHRoaXMuZ2V0QXV0b21hdGlvbklkKGVsZW1lbnRJZCk7XG4gIGxldCBwYXJhbXMgPSB7XG4gICAgZWxlbWVudElkLFxuICAgIHRleHQ6IHZhbHVlLFxuICAgIHJlcGxhY2U6IHRydWVcbiAgfTtcbiAgcmV0dXJuIGF3YWl0IHRoaXMuYm9vdHN0cmFwLnNlbmRBY3Rpb24oXCJlbGVtZW50OnNldFRleHRcIiwgcGFyYW1zKTtcbn07XG5cbmNvbW1hbmRzLmNsaWNrID0gYXN5bmMgZnVuY3Rpb24gKGVsZW1lbnRJZCwgeCA9IDAsIHkgPSAwKSB7XG4gIGlmICh4ID09PSB0aGlzLnNlc3Npb25JZCkge1xuICAgIHggPSAwO1xuICB9XG4gIGlmICh5ID09PSB0aGlzLnNlc3Npb25JZCkge1xuICAgIHkgPSAwO1xuICB9XG5cbiAgaWYgKGVsZW1lbnRJZCkge1xuICAgIGVsZW1lbnRJZCA9IHRoaXMuZ2V0QXV0b21hdGlvbklkKGVsZW1lbnRJZCk7XG4gIH0gZWxzZSB7XG4gICAgZWxlbWVudElkID0gXCJcIjtcbiAgfVxuXG4gIGxldCBwYXJhbXMgPSB7XG4gICAgZWxlbWVudElkLFxuICAgIHg6IF8udG9JbnRlZ2VyKHgpLFxuICAgIHk6IF8udG9JbnRlZ2VyKHkpXG4gIH07XG4gIHJldHVybiBhd2FpdCB0aGlzLmJvb3RzdHJhcC5zZW5kQWN0aW9uKFwiZWxlbWVudDpjbGlja1wiLCBwYXJhbXMpO1xufTtcblxuY29tbWFuZHMudG91Y2hVcCA9IGFzeW5jIGZ1bmN0aW9uICh4ID0gMSwgeSA9IDEsIGVsZW1lbnRJZCA9IFwiXCIpIHtcbiAgaWYgKGVsZW1lbnRJZCAmJiBlbGVtZW50SWQgIT09IHRoaXMuc2Vzc2lvbklkKSB7XG4gICAgZWxlbWVudElkID0gdGhpcy5nZXRBdXRvbWF0aW9uSWQoZWxlbWVudElkKTtcbiAgfSBlbHNlIHtcbiAgICBlbGVtZW50SWQgPSBcIlwiO1xuICB9XG5cbiAgbGV0IHBhcmFtcyA9IHtcbiAgICBlbGVtZW50SWQsXG4gICAgeDogXy50b0ludGVnZXIoeCksXG4gICAgeTogXy50b0ludGVnZXIoeSlcbiAgfTtcbiAgcmV0dXJuIGF3YWl0IHRoaXMuYm9vdHN0cmFwLnNlbmRBY3Rpb24oXCJlbGVtZW50OnRvdWNoVXBcIiwgcGFyYW1zKTtcbn07XG5cbmNvbW1hbmRzLnRvdWNoRG93biA9IGFzeW5jIGZ1bmN0aW9uICh4LCB5LCBlbGVtZW50SWQgPSBcIlwiKSB7XG4gIGlmIChlbGVtZW50SWQgJiYgZWxlbWVudElkICE9PSB0aGlzLnNlc3Npb25JZCkge1xuICAgIGVsZW1lbnRJZCA9IHRoaXMuZ2V0QXV0b21hdGlvbklkKGVsZW1lbnRJZCk7XG4gIH0gZWxzZSB7XG4gICAgZWxlbWVudElkID0gXCJcIjtcbiAgfVxuXG4gIGxldCBwYXJhbXMgPSB7XG4gICAgZWxlbWVudElkLFxuICAgIHg6IF8udG9JbnRlZ2VyKHgpLFxuICAgIHk6IF8udG9JbnRlZ2VyKHkpXG4gIH07XG4gIHJldHVybiBhd2FpdCB0aGlzLmJvb3RzdHJhcC5zZW5kQWN0aW9uKFwiZWxlbWVudDp0b3VjaERvd25cIiwgcGFyYW1zKTtcbn07XG5cbmNvbW1hbmRzLnRvdWNoTW92ZSA9IGFzeW5jIGZ1bmN0aW9uICh4RG93biwgeURvd24sIHhVcCwgeVVwLCBzdGVwcyA9IDEwLCBlbGVtZW50SWQgPSBudWxsKSB7XG4gIGlmIChlbGVtZW50SWQgJiYgZWxlbWVudElkICE9PSB0aGlzLnNlc3Npb25JZCkge1xuICAgIGVsZW1lbnRJZCA9IHRoaXMuZ2V0QXV0b21hdGlvbklkKGVsZW1lbnRJZCk7XG4gIH0gZWxzZSB7XG4gICAgZWxlbWVudElkID0gXCJcIjtcbiAgfVxuXG4gIGxldCBwYXJhbXMgPSB7XG4gICAgZWxlbWVudElkLFxuICAgIHhEb3duOiBfLnRvSW50ZWdlcih4RG93biksXG4gICAgeURvd246IF8udG9JbnRlZ2VyKHlEb3duKSxcbiAgICB4VXA6IF8udG9JbnRlZ2VyKHhVcCksXG4gICAgeVVwOiBfLnRvSW50ZWdlcih5VXApLFxuICAgIHN0ZXBzOiBfLnRvSW50ZWdlcihzdGVwcylcbiAgfTtcbiAgcmV0dXJuIGF3YWl0IHRoaXMuYm9vdHN0cmFwLnNlbmRBY3Rpb24oXCJlbGVtZW50OnRvdWNoTW92ZVwiLCBwYXJhbXMpO1xufTtcblxuY29tbWFuZHMudG91Y2hMb25nQ2xpY2sgPSBhc3luYyBmdW5jdGlvbiAoZWxlbWVudElkLCB4LCB5LCBkdXJhdGlvbikge1xuICBhd2FpdCB0aGlzLnRvdWNoRG93bih4LCB5LCBlbGVtZW50SWQpO1xuICBhd2FpdCBzbGVlcChkdXJhdGlvbik7XG4gIHJldHVybiBhd2FpdCB0aGlzLnRvdWNoVXAoeCwgeSwgZWxlbWVudElkKTtcbn07XG5cbmNvbW1hbmRzLnRhcCA9IGFzeW5jIGZ1bmN0aW9uIChlbGVtZW50SWQsIHggPSAwLCB5ID0gMCwgY291bnQgPSAxKSB7XG4gIGxldCByZXN1bHQgPSB0cnVlO1xuICBsZXQgdGFwUmVzdWx0ID0gZmFsc2U7XG4gIGZvciAobGV0IGkgPSAwOyBpIDwgY291bnQ7IGkrKykge1xuICAgIHRhcFJlc3VsdCA9IGF3YWl0IHRoaXMuY2xpY2soZWxlbWVudElkLCB4LCB5KTtcbiAgICBpZiAoIXRhcFJlc3VsdCkge1xuICAgICAgcmVzdWx0ID0gZmFsc2U7XG4gICAgfVxuICB9XG4gIHJldHVybiByZXN1bHQ7XG59O1xuXG5PYmplY3QuYXNzaWduKGV4dGVuc2lvbnMsIGNvbW1hbmRzKTtcbmV4cG9ydCB7IGNvbW1hbmRzIH07XG5leHBvcnQgZGVmYXVsdCBleHRlbnNpb25zO1xuIl0sImZpbGUiOiJsaWIvY29tbWFuZHMvZWxlbWVudC5qcyIsInNvdXJjZVJvb3QiOiIuLi8uLi8uLiJ9
